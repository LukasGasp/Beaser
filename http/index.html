<!DOCTYPE html>
<html>

<head>
    <title>Beaser</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <table>
        <tr>
            <td class="dot"></td>
            <td class="title">Beaser</td>
        </tr>
    </table>


    <br>
    <br>

    <div class="flex-container">
        <section>
            <h3 class="subtitle">Status</h3>
            <div id="info" class="flex-item">
                <table>
                    <tr>
                        <th>Ping</th>
                        <th>
                            <p id="status" class="tablevalue">pinging...</p>
                        </th>
                    </tr>
                    <tr>
                        <th>IP</th>
                        <th>
                            <p id="ip" class="tablevalue">UNKNOWN</p>
                        </th>
                    </tr>
                    <tr>
                        <th>Host</th>
                        <th>
                            <p id="host" class="tablevalue">UNKNOWN</p>
                        </th>
                    </tr>
                    <tr>
                        <th>Port</th>
                        <th>
                            <p id="port" class="tablevalue">UNKNOWN</p>
                        </th>
                    </tr>
                </table>
            </div>
        </section>

        <section>
            <h3 class="subtitle">DMX</h3>
            <div id="info" class="flex-item">
                <table>
                    <tr>
                        <th>Universe</th>
                        <th>
                            <p id="universe" class="tablevalue">pinging...</p>
                        </th>
                    </tr>
                    <tr>
                        <th>Address</th>
                        <th>
                            <p id="address" class="tablevalue">UNKNOWN</p>
                        </th>
                    </tr>
                    <tr>
                        <th>Panel</th>
                        <th>
                            <p id="panel" class="tablevalue">UNKNOWN</p>
                        </th>
                    </tr>
                    <tr>
                        <th>Status</th>
                        <th>
                            <p id="port" class="tablevalue">/TODO</p>
                        </th>
                    </tr>
                </table>
            </div>
        </section>

        <section>
            <h3 class="subtitle">Control</h3>
            <div id="info" class="flex-item">
                <button class="button button_green">Name</button>
                <button class="button button_green">Gobos</button>
                <br>
                <button class="button button_yellow">DMX-Addr.</button>
                <button class="button button_yellow">Panel</button>
                <br>
                <button class="button button_red">Pattern</button>
                <button class="button button_red">Shutdown</button>
            </div>
        </section>

        <section>
            <h3 class="subtitle">Footprint (Panel)</h3>
            <div id="info" class="flex-item">
                <table>
                    <tr>
                        <td><br></td>
                    </tr>
                    <tr>
                        <th>1.</th>
                        <td>Mode</td>
                    </tr>
                    <tr>
                        <th>2.</th>
                        <td>Dimmer</td>
                    </tr>
                    <tr>
                        <th>3.</th>
                        <td>x-Position</td>
                    </tr>
                    <tr>
                        <th>4.</th>
                        <td>y-Postition</td>
                    </tr>
                    <tr>
                        <th>5.</th>
                        <td>x-Size</td>
                    </tr>
                    <tr>
                        <th>6.</th>
                        <td>y-Size</td>
                    </tr>
                    <tr>
                        <th>7.</th>
                        <td>Rotation
                        </td>
                    </tr>
                    <tr>
                        <th>8.</th>
                        <td>Red</td>
                    </tr>
                    <tr>
                        <th>9.</th>
                        <td>Green</td>
                    </tr>
                    <tr>
                        <th>10.</th>
                        <td>Blue</td>
                    </tr>
                    <tr>
                        <th>11.</th>
                        <td>Effect-Options</td>
                    </tr>
                    <tr>
                        <td><br></td>
                    </tr>
                </table>
            </div>
        </section>
    </div>

    <div class="flex-container">
        <section>
            <h3 class="subtitle">Logs</h3>
            <div id="info" class="flex-item">
                <table id="log-table">
                    <thead>
                        <tr>
                            <th>Zeitstempel</th>
                            <th>Nachricht</th>
                            <th>Comming soon...</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
            </div>
        </section>
    </div>

    <script>
        const pingServer = async () => {
            try {
                const response = await fetch('/ping');
                if (response.status === 200) {
                    document.getElementById('status').innerHTML = 'Yes';
                    document.querySelector('.dot').classList.remove('down');
                    document.querySelector('.dot').classList.add('up');
                } else {
                    document.getElementById('status').innerHTML = 'down';
                    document.querySelector('.dot').classList.remove('up');
                    document.querySelector('.dot').classList.add('down');
                }
            } catch (error) {
                document.getElementById('status').innerHTML = "down";
                document.querySelector('.dot').classList.remove('up');
                document.querySelector('.dot').classList.add('down');
            }
        };

        pingServer();
        setInterval(pingServer, 1000);

        const getIp = async () => {
            try {
                const response = await fetch('/ip');
                const ip = await response.text();
                return ip;
            } catch (error) {
                return 'UNKNOWN';
            }
        };

        const getPort = async () => {
            try {
                const response = await fetch('/port');
                const port = await response.text();
                return port;
            } catch (error) {
                return 'UNKNOWN';
            }
        };

        const getHost = async () => {
            try {
                const response = await fetch('/host');
                const host = await response.text();
                return host;
            } catch (error) {
                return 'UNKNOWN';
            }
        };

        const updateIpAndPort = async () => {
            const ip = await getIp();
            const port = await getPort();
            const host = await getHost();
            document.getElementById('ip').innerHTML = `${ip}`;
            document.getElementById('port').innerHTML = `${port}`;
            document.getElementById('host').innerHTML = `${host}`;
        };

        updateIpAndPort();
        setInterval(updateIpAndPort, 5000);

        const getUniverse = async () => {
            try {
                const response = await fetch('/universe');
                const universe = await response.text();
                return universe;
            } catch (error) {
                return 'UNKNOWN';
            }
        };

        const getdmxaddress = async () => {
            try {
                const response = await fetch('/dmx');
                const address = await response.text();
                return address;
            } catch (error) {
                return 'UNKNOWN';
            }
        };

        const getpanel = async () => {
            try {
                const response = await fetch('/panel');
                const panel = await response.text();
                return panel;
            } catch (error) {
                return 'UNKNOWN';
            }
        };

        const updatedmx = async () => {
            const universe = await getUniverse();
            const address = await getdmxaddress();
            const panel = await getpanel();
            document.getElementById('universe').innerHTML = `${universe}`;
            document.getElementById('address').innerHTML = `${address}`;
            document.getElementById('panel').innerHTML = `${panel}`;
        };

        updatedmx();
        setInterval(updatedmx, 5000);
    </script>
</body>
<footer>
    <p>&copy; 2023 Beaser by LukasGasp</p>
</footer>

</html>